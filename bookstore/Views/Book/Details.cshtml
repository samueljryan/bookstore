@model bookstore.Models.BookModel
@using System.Security.Claims;

@{
    ViewData["Title"] = "Details";
}


<style>

    .rating-list {
        display: inline-flex;
        margin-bottom: 15px;
        width: 100%;
    }

    .rating-list-left {
        height: 16px;
        line-height: 29px;
        width: 10%;
    }

    .rating-list-center {
        width: 80%;
    }

    .rating-list-right {
        line-height: 29px;
        text-align: right;
        width: 10%;
    }


    .offer-dedicated-nav .nav-link.active,
    .offer-dedicated-nav .nav-link:hover,
    .offer-dedicated-nav .nav-link:focus {
        border-color: #3868fb;
        color: #3868fb;
    }

    .offer-dedicated-nav .nav-link {
        border-bottom: 2px solid #fff;
        color: #000000;
        padding: 16px 0;
        font-weight: 600;
    }

    .offer-dedicated-nav .nav-item {
        margin: 0 37px 0 0;
    }


    .rounded-pill {
        border-radius: 50rem !important;
    }


    .progress {
        background: #f2f4f8 none repeat scroll 0 0;
        border-radius: 0;
        height: 30px;
    }

    .rating-list {
        display: inline-flex;
        margin-bottom: 15px;
        width: 100%;
    }

    .rating-list-left {
        height: 16px;
        line-height: 29px;
        width: 10%;
    }

    .rating-list-center {
        width: 80%;
    }

    .rating-list-right {
        line-height: 29px;
        text-align: right;
        width: 10%;
    }



    .progress {
        background: #f2f4f8 none repeat scroll 0 0;
        border-radius: 0;
        height: 30px;
    }

    .txt-center {
        text-align: center;
    }

    .hide {
        display: none;
    }

    .clear {
        float: none;
        clear: both;
    }
</style>














<h1>Details</h1>

<section class="py-5">
    <div class="container px-4 px-lg-5 my-5">
        <div class="row gx-4 gx-lg-5 align-items-center">
            <div class="col-md-6">
                <img src="@("~/Image/"+ViewBag.picName)" asp-append-version="true" width="500" height="700" />
                <br />
                <br />

                <div class="d-flex">
                    <a class="btn btn-outline-dark flex-shrink-0" type="button" asp-controller="WishList" asp-action="AddtoWishlist" asp-route-id="@Model.Id">
                        Add to Wishlist
                    </a>
                </div>
            </div>

            <div class="col-md-6">

                <h1 class="display-5 fw-bolder"> @Html.DisplayFor(model => model.Title) </h1>
                <h5 class="fs-5 mb-5"> @Html.DisplayFor(model => model.AuthorName) </h5>
                <div class="fs-5 mb-5">
                    <span>$@Html.DisplayFor(model => model.Price)</span>
                </div>
                <p class="lead">
                    @Html.DisplayFor(model => model.Description)
                </p>

                <br />
                <br />

                <div class="d-flex">
                    <a class="btn btn-outline-dark flex-shrink-0" type="button" asp-controller="Cart" asp-action="AddtoCartDetails" asp-route-id="@Model.Id">
                        <i class="bi-cart-fill me-1"></i>
                        Add to Cart
                    </a>
                </div>

            </div>
        </div>
    </div>
    <div>
        @if (User.IsInRole("Admin"))
        {
            <a asp-action="Edit" asp-route-id="@Model.Id">Edit |</a>
        }
        
        <a asp-action="Index">Back to List</a>
    </div>
</section>

<br />
<br />

@{ await Html.RenderPartialAsync("~/Views/Book/_AddReview.cshtml", new bookstore.Models.ReviewModel { ItemId = Model.Id });}

<hr />

<table class="table">
    <thead>
        <tr>
            <th>
                <h5 class="mb-1">All Ratings and Reviews</h5>
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var review in ViewBag.reviews)
        {
            <tr>
                <td>

                    <!-- Loops through reviews here -->
                    <div class="bg-white rounded shadow-sm p-4 mb-4 restaurant-detailed-ratings-and-reviews">

                        <div class="reviews-members pt-4 pb-4">
                            <div class="media">

                                <div class="media-body">
                                    <div class="reviews-members-header">
                                        <!-- if rating then missing <a> accordingly  -->
                                        <span class="star-rating float-right">
                                            @if (review.Rating == 5)
                                            {
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>

                                            }
                                            @if (review.Rating == 4)
                                            {
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <i class="icofont-ui-rating active"></i>

                                            }
                                            @if (review.Rating == 3)
                                            {
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>

                                            }
                                            @if (review.Rating == 2)
                                            {
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>

                                            }
                                            @if (review.Rating == 1)
                                            {
                                                <a href="#"><i class="icofont-ui-rating active"></i></a>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>
                                                <i class="icofont-ui-rating active"></i>

                                            }
                                        </span>
                                        <h6 class="mb-1"><a class="text-black" href="#">@review.Name</a></h6>
                                        <p class="text-gray">@review.Created</p>
                                    </div>
                                    <div class="reviews-members-body">
                                        <p>@review.Review</p>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <hr>
                    </div>
                </td>
                <td>
                    <div>
                        @if ((review.UserId == User.FindFirstValue(ClaimTypes.NameIdentifier) && User.Identity.IsAuthenticated) || User.IsInRole("Admin"))
                        {
                            <a asp-controller="Review" asp-action="Edit" asp-route-id="@review.Id">Edit |</a>
                            <a asp-controller="Review" asp-action="Delete" asp-route-id="@review.Id">Delete</a>
                        }


                    </div>

                </td>
            </tr>
        }
    </tbody>
</table>








<link rel="stylesheet" href="https://allyoucan.cloud/cdn/icofont/1.0.1/icofont.css" integrity="sha384-jbCTJB16Q17718YM9U22iJkhuGbS0Gd2LjaWb4YJEZToOPmnKDjySVa323U+W7Fv" crossorigin="anonymous">
<div class="container">
    <div class="col-md-12">
        <div class="offer-dedicated-body-left">
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade" id="pills-order-online" role="tabpanel" aria-labelledby="pills-order-online-tab">


                </div>

                <div class="tab-pane fade" id="pills-restaurant-info" role="tabpanel" aria-labelledby="pills-restaurant-info-tab">

                </div>

                <div class="tab-pane fade active show" id="pills-reviews" role="tabpanel" aria-labelledby="pills-reviews-tab">

                    <div class="bg-white rounded shadow-sm p-4 mb-4 clearfix graph-star-rating">
                        <h5 class="mb-0 mb-4">Ratings and Reviews</h5>
                        <div class="graph-star-rating-header">
                            <div class="star-rating">
                                @if (ViewBag.avgRating == 5)
                                {
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating"></i></a> <b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }
                                @if (ViewBag.avgRating == 4)
                                {
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <i class="icofont-ui-rating"></i> <b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }
                                @if (ViewBag.avgRating == 3)
                                {
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating"></i> <b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }
                                @if (ViewBag.avgRating == 2)
                                {
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating"></i> <b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }
                                @if (ViewBag.avgRating == 1)
                                {
                                    <a href="#"><i class="icofont-ui-rating active"></i></a>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating"></i><b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }
                                @if (ViewBag.avgRating == 0)
                                {
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating active"></i>
                                    <i class="icofont-ui-rating"></i> <b class="text-black ml-2">@ViewBag.totalRatings</b>
                                }

                            </div>
                            @if (ViewBag.avgRating == 0)
                            {
                                <p class="text-black mb-4 mt-2">Be the first to rate and review</p>
                            }
                            else
                            {
                                <p class="text-black mb-4 mt-2">Rated @ViewBag.avgRating out of 5</p>
                            }

                        </div>
                        <div class="graph-star-rating-body">
                            <div class="rating-list">
                                <div class="rating-list-left text-black">
                                    5 Star
                                </div>
                                <div class="rating-list-center">
                                    <div class="progress">
                                        <div style="width: @ViewBag.percentOfFive%" aria-valuemax="5" aria-valuemin="0" aria-valuenow="5" role="progressbar" class="progress-bar bg-primary">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rating-list-right text-black">@ViewBag.percentOfFive%</div>
                            </div>
                            <div class="rating-list">
                                <div class="rating-list-left text-black">
                                    4 Star
                                </div>
                                <div class="rating-list-center">
                                    <div class="progress">
                                        <div style="width: @ViewBag.percentOfFour%" aria-valuemax="5" aria-valuemin="0" aria-valuenow="5" role="progressbar" class="progress-bar bg-primary">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rating-list-right text-black">@ViewBag.percentOfFour%</div>
                            </div>
                            <div class="rating-list">
                                <div class="rating-list-left text-black">
                                    3 Star
                                </div>
                                <div class="rating-list-center">
                                    <div class="progress">
                                        <div style="width: @ViewBag.percentOfThree%" aria-valuemax="5" aria-valuemin="0" aria-valuenow="5" role="progressbar" class="progress-bar bg-primary">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rating-list-right text-black">@ViewBag.percentOfThree%</div>
                            </div>
                            <div class="rating-list">
                                <div class="rating-list-left text-black">
                                    2 Star
                                </div>
                                <div class="rating-list-center">
                                    <div class="progress">
                                        <div style="width: @ViewBag.percentOfTwo%" aria-valuemax="5" aria-valuemin="0" aria-valuenow="5" role="progressbar" class="progress-bar bg-primary">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rating-list-right text-black">@ViewBag.percentOfTwo%</div>
                            </div>
                            <div class="rating-list">
                                <div class="rating-list-left text-black">
                                    1 Star
                                </div>
                                <div class="rating-list-center">
                                    <div class="progress">
                                        <div style="width: @ViewBag.percentOfOne%" aria-valuemax="5" aria-valuemin="0" aria-valuenow="5" role="progressbar" class="progress-bar bg-primary">
                                            <span class="sr-only">80% Complete (danger)</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="rating-list-right text-black">@ViewBag.percentOfOne%</div>
                            </div>
                        </div>

                    </div>



                </div>
            </div>
        </div>
    </div>
</div>
